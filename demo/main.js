!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.createPoster=e():t.createPoster=e()}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);var n=class{constructor(t){this.params=Object.assign({container:document.body,width:250,height:150,fontSize:16,font:"microsoft yahei",color:"#cccccc",content:"watermark",rotate:-30,zIndex:1e3,opacity:.5},t),this.styleStr=`\n    position:absolute;\n    top:0;\n    left:0;\n    width:100%;\n    height:100%;\n    z-index:${this.params.zIndex};\n    pointer-events:none;\n    background-repeat:repeat;\n    background-image:url('${this.toDataURL()}')`,this.params.x=this.isNullOrUndefined(t.x)?this.params.width/2:t.x,this.params.y=this.isNullOrUndefined(t.y)?this.params.height/2:t.y,this.containerObserver=new MutationObserver((t,e)=>{t.forEach(t=>{document.getElementsByClassName("open-watermark")[0]||(this.createWatermarkDom(),this.isFunction(this.params.onWatermarkChanged)&&this.params.onWatermarkChanged(t,e))})}),this.observer=new MutationObserver((t,e)=>{t.forEach(t=>{const r=document.getElementsByClassName("open-watermark")[0];r&&r.getAttribute("style")!==this.styleStr&&(r.setAttribute("style",this.styleStr),this.isFunction(this.params.onWatermarkChanged)&&this.params.onWatermarkChanged(t,e))})})}isNullOrUndefined(t){return null==t}isFunction(t){return"function"==typeof t}isDom(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName}toDataURL(){const{width:t,height:e,fontSize:r,font:n,color:a,rotate:i,content:o,opacity:s,x:c,y:u}=this.params,l=document.createElement("canvas");l.setAttribute("width",t+"px"),l.setAttribute("height",e+"px");const h=l.getContext("2d");return h&&(h.clearRect(0,0,t,e),h.textBaseline="top",h.textAlign="left",h.fillStyle=a,h.globalAlpha=s,h.font=`${r}px ${n}`,h.translate(c,u),h.rotate(Math.PI/180*i),h.translate(-c,-u-r),h.fillText(o,c,u+r)),l.toDataURL()}createWatermarkDom(){const t=document.getElementsByClassName("open-watermark")[0],{container:e}=this.params;this.isDom(e)&&!t&&(this.watermarkDiv=document.createElement("div"),this.watermarkDiv.setAttribute("style",this.styleStr),this.watermarkDiv.setAttribute("class","open-watermark"),e.style.position="relative",e.insertBefore(this.watermarkDiv,e.firstChild),this.observer.observe(this.watermarkDiv,{attributes:!0,childList:!0,subtree:!0}))}output(){this.flag=!0,this.createWatermarkDom(),this.containerObserver.observe(this.params.container,{attributes:!0,childList:!0,characterData:!0})}destroy(){this.watermarkDiv&&(this.watermarkDiv.remove(),this.observer.disconnect(),this.containerObserver.disconnect())}};function a(t){return new n(t)}window.TWatermark=a;e.default=a}]).default}));